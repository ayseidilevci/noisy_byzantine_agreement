# Byzantine Agreement Protocol in a Small Quantum Network


## Project Files


The repository is organized into 3 subfolders:

- `no_noise/`: Implements the Weak Broadcast Protocol under the **no noise** configuration (used for reproducing Figure 4) Includes:
  - `no_faulty/`: Each party implemented is reliable. Reproduces Figure 4a.
  - `r0_faulty/`: Implements receiver 1 as the faulty party. Reproduces Figure 4c.
  - `s_faulty/`: Implements sender as the faulty party. Reproduces Figure 4b. 
  - `findings/`: Includes graphs generated by the above folders.
- `leakage_error_bitflip/`: Implements the protocol with a bit-flip noise model to simulate leakage errors. The remaining structure of this folder is the same as the folder `no_noise/`.
- `leakage_error_nv/`: Implements the protocol on a Nitrogen-Vacancy center device type with the Kraus Operator noise model already implemented by SquidASm to simulate leakage errors. The remaining structure of this folder is the same as the folder `no_noise/`.

Each folder contains the following files:

- `application.py`: Implements the `Sender`, `Receiver0`, and `Receiver1` programs.
- `run_simulation.py`: Runs the Byzantine Agreement Protocol simulation over a range of values for the number of 4-qubit singlet states `M`, and collects Monte Carlo failure statistics.
- `config.yaml`: Network configuration for SquidASM.


## How to Run

1. **Clone and install SquidASM** (required once):
    
Create an account for the [netsquid forum](https://forum.netsquid.org/ucp.php?mode=register).
```
git clone https://github.com/QuTech-Delft/squidasm.git
export NETSQUIDPYPI_USER=user1234
export NETSQUIDPYPI_PWD=password1234
cd squidasm
make install
make verify.
```
For more detailed instructions you can check [this website](https://squidasm.readthedocs.io/en/latest/installation.html).

2. Run the simulation:
```
cd byzantinen_agreement_protocol/no_faulty_protocol OR cd byzantinen_agreement_protocol/leakage_error
python3 run_simulation.py
```

## Parameters

The simulation evaluates the failure probability of the Weak Broadcast Protocol as a function of the number of entangled four-qubit singlet states used in each trial (`M`).

### Key Parameters:

- **`M`** — Number of four-qubit singlet states per protocol run.
  - Varies to test how failure probability decreases with more resources.
  - Typical tested range: `M = 20` to `M = 400` in steps (e.g., 20).
- **`N`** — Number of Monte Carlo repetitions (random trials) per value of `M`.
  - Default: `N = 100`
  - Paper used `N = 10,000`, but that is computationally expensive.

### Protocol Constants (based on the paper):
- **μ = 0.272** — Check threshold fraction.
- **λ = 0.94** — Cross-check correction threshold.

These are used in the check and cross-check phases to determine whether a receiver accepts the sender's value.

> Note: For large `M` and `N`, simulations can be computationally intensive.

## Reference

This project is based on the following paper:

> **Resource analysis for quantum-aided Byzantine agreement with the four-qubit singlet state**  
> *Quantum*, 8, 1324 (2024).  
> DOI: [10.22331/q-2024-04-30-1324](https://doi.org/10.22331/q-2024-04-30-1324)  
> [https://quantum-journal.org/papers/q-2024-04-30-1324/](https://quantum-journal.org/papers/q-2024-04-30-1324/)

The protocol implementation, circuit structure, and simulation design closely follow the methodology outlined in this paper.

---

## Dependencies

To run this project, make sure the following are installed:

- Python **3.9+**
- [`SquidASM`](https://gitlab.com/softwarequtech/squidasm) (installed as an editable package)
- `matplotlib` — for plotting the failure probabilities
- `numpy` — for numerical operations

You can install the dependencies (excluding SquidASM) using:

```
pip install matplotlib numpy
```
